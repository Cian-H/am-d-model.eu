{
	admin off
	http_port 80
	https_port 443
	servers {
		trusted_proxies static private_ranges
		protocols h1 h2 h3
		max_header_size 16k
	}
}

am-d-model.eu {
	reverse_proxy site:3000 {
		health_uri /health
		health_interval 30s
		health_timeout 10s
		health_status 200
	}
}

invenio.am-d-model.eu {
	header {
		Strict-Transport-Security "max-age=31536000;"
		X-Frame-Options "SAMEORIGIN"
		X-Content-Type-Options "nosniff"
		Referrer-Policy "strict-origin-when-cross-origin"
	}
	request_body {
		max_size 1TB
	}
	root /static/* /opt/invenio/var/instance/static
	try_files {path} {path}/ /index.html
	reverse_proxy invenio-rdm:5000 {
		transport http {
			dial_timeout 10s
			response_header_timeout 5m
		}
	}
	file_server
	encode gzip
}
